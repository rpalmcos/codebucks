{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"Router\", {\n  enumerable: true,\n  get: function () {\n    return _router.default;\n  }\n});\nObject.defineProperty(exports, \"withRouter\", {\n  enumerable: true,\n  get: function () {\n    return _withRouter.default;\n  }\n});\nexports.useRouter = useRouter;\nexports.createRouter = createRouter;\nexports.makePublicRouterInstance = makePublicRouterInstance;\nexports.default = void 0;\nvar _interop_require_default = require(\"@swc/helpers/lib/_interop_require_default.js\").default;\nvar _react = _interop_require_default(require(\"react\"));\nvar _router = _interop_require_default(require(\"../shared/lib/router/router\"));\nvar _routerContext = require(\"../shared/lib/router-context\");\nvar _isError = _interop_require_default(require(\"../lib/is-error\"));\nvar _withRouter = _interop_require_default(require(\"./with-router\"));\nconst singletonRouter = {\n  router: null,\n  readyCallbacks: [],\n  ready(cb) {\n    if (this.router) return cb();\n    if (typeof window !== 'undefined') {\n      this.readyCallbacks.push(cb);\n    }\n  }\n};\n// Create public properties and methods of the router in the singletonRouter\nconst urlPropertyFields = ['pathname', 'route', 'query', 'asPath', 'components', 'isFallback', 'basePath', 'locale', 'locales', 'defaultLocale', 'isReady', 'isPreview', 'isLocaleDomain', 'domainLocales'];\nconst routerEvents = ['routeChangeStart', 'beforeHistoryChange', 'routeChangeComplete', 'routeChangeError', 'hashChangeStart', 'hashChangeComplete'];\nconst coreMethodFields = ['push', 'replace', 'reload', 'back', 'prefetch', 'beforePopState'];\n// Events is a static property on the router, the router doesn't have to be initialized to use it\nObject.defineProperty(singletonRouter, 'events', {\n  get() {\n    return _router.default.events;\n  }\n});\nfunction getRouter() {\n  if (!singletonRouter.router) {\n    const message = 'No router instance found.\\n' + 'You should only use \"next/router\" on the client side of your app.\\n';\n    throw new Error(message);\n  }\n  return singletonRouter.router;\n}\nurlPropertyFields.forEach(field => {\n  // Here we need to use Object.defineProperty because we need to return\n  // the property assigned to the actual router\n  // The value might get changed as we change routes and this is the\n  // proper way to access it\n  Object.defineProperty(singletonRouter, field, {\n    get() {\n      const router = getRouter();\n      return router[field];\n    }\n  });\n});\ncoreMethodFields.forEach(field => {\n  singletonRouter[field] = function () {\n    const router = getRouter();\n    return router[field](...arguments);\n  };\n});\nrouterEvents.forEach(event => {\n  singletonRouter.ready(() => {\n    _router.default.events.on(event, function () {\n      const eventField = `on${event.charAt(0).toUpperCase()}${event.substring(1)}`;\n      const _singletonRouter = singletonRouter;\n      if (_singletonRouter[eventField]) {\n        try {\n          _singletonRouter[eventField](...arguments);\n        } catch (err) {\n          console.error(`Error when running the Router event: ${eventField}`);\n          console.error((0, _isError).default(err) ? `${err.message}\\n${err.stack}` : err + '');\n        }\n      }\n    });\n  });\n});\nvar _default = singletonRouter;\nexports.default = _default;\nfunction useRouter() {\n  const router = _react.default.useContext(_routerContext.RouterContext);\n  if (!router) {\n    throw new Error('NextRouter was not mounted. https://nextjs.org/docs/messages/next-router-not-mounted');\n  }\n  return router;\n}\nfunction createRouter() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n  singletonRouter.router = new _router.default(...args);\n  singletonRouter.readyCallbacks.forEach(cb => cb());\n  singletonRouter.readyCallbacks = [];\n  return singletonRouter.router;\n}\nfunction makePublicRouterInstance(router) {\n  const scopedRouter = router;\n  const instance = {};\n  for (const property of urlPropertyFields) {\n    if (typeof scopedRouter[property] === 'object') {\n      instance[property] = Object.assign(Array.isArray(scopedRouter[property]) ? [] : {}, scopedRouter[property]) // makes sure query is not stateful\n      ;\n\n      continue;\n    }\n    instance[property] = scopedRouter[property];\n  }\n  // Events is a static property on the router, the router doesn't have to be initialized to use it\n  instance.events = _router.default.events;\n  coreMethodFields.forEach(field => {\n    instance[field] = function () {\n      return scopedRouter[field](...arguments);\n    };\n  });\n  return instance;\n}\nif ((typeof exports.default === 'function' || typeof exports.default === 'object' && exports.default !== null) && typeof exports.default.__esModule === 'undefined') {\n  Object.defineProperty(exports.default, '__esModule', {\n    value: true\n  });\n  Object.assign(exports.default, exports);\n  module.exports = exports.default;\n}","map":{"version":3,"names":["_router","default","useRouter","createRouter","makePublicRouterInstance","_react","_interop_require_default","require","_routerContext","_isError","singletonRouter","router","readyCallbacks","ready","cb","window","push","urlPropertyFields","routerEvents","coreMethodFields","Object","defineProperty","get","events","getRouter","message","Error","forEach","field","arguments","event","on","eventField","charAt","toUpperCase","substring","_singletonRouter","err","console","error","stack","useContext","RouterContext","_len","length","args","Array","_key","scopedRouter","instance","property","assign","isArray"],"sources":["../../src/client/router.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}